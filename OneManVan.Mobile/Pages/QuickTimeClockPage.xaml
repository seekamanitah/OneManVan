<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:OneManVan.Mobile.Controls"
             x:Class="OneManVan.Mobile.Pages.QuickTimeClockPage"
             Title="Time Clock"
             BackgroundColor="{AppThemeBinding Light={StaticResource LightBackground}, Dark={StaticResource DarkBackground}}">

    <Grid RowDefinitions="Auto,Auto,*,Auto">

        <!-- Current Status Banner -->
        <Frame Grid.Row="0"
               x:Name="StatusBanner"
               Margin="16"
               Padding="20"
               CornerRadius="16"
               HasShadow="True"
               BackgroundColor="{StaticResource Success}"
               BorderColor="Transparent">
            <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
                <Label x:Name="StatusLabel"
                       Text="NOT CLOCKED IN"
                       FontSize="24"
                       FontAttributes="Bold"
                       TextColor="White"
                       HorizontalTextAlignment="Center"/>
                <Label x:Name="CurrentJobLabel"
                       Text="Select a job to clock in"
                       FontSize="14"
                       TextColor="White"
                       Opacity="0.9"
                       HorizontalTextAlignment="Center"/>
                <Label x:Name="DurationLabel"
                       Text="00:00:00"
                       FontSize="36"
                       FontAttributes="Bold"
                       TextColor="White"
                       HorizontalTextAlignment="Center"
                       IsVisible="False"/>
            </VerticalStackLayout>
        </Frame>

        <!-- Today's Jobs Header -->
        <Label Grid.Row="1"
               Text="Today's Jobs"
               FontSize="18"
               FontAttributes="Bold"
               Margin="16,0,16,8"
               TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray50}}"/>

        <!-- Jobs List for Quick Selection -->
        <CollectionView Grid.Row="2"
                        x:Name="TodayJobsCollection"
                        SelectionMode="Single"
                        SelectionChanged="OnJobSelected"
                        Margin="16,0">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Margin="0,4"
                           Padding="16"
                           CornerRadius="12"
                           HasShadow="True"
                           BackgroundColor="{AppThemeBinding Light={StaticResource LightCard}, Dark={StaticResource DarkCard}}"
                           BorderColor="Transparent">
                        <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto">
                            
                            <!-- Job Title -->
                            <Label Grid.Row="0" Grid.Column="0"
                                   Text="{Binding Title}"
                                   FontSize="16"
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray50}}"/>
                            
                            <!-- Status Badge -->
                            <Frame Grid.Row="0" Grid.Column="1"
                                   Padding="8,4"
                                   CornerRadius="8"
                                   BackgroundColor="{Binding StatusColor}"
                                   BorderColor="Transparent">
                                <Label Text="{Binding StatusText}"
                                       TextColor="White"
                                       FontSize="10"
                                       FontAttributes="Bold"/>
                            </Frame>
                            
                            <!-- Customer -->
                            <Label Grid.Row="1" Grid.ColumnSpan="2"
                                   Text="{Binding CustomerName}"
                                   FontSize="14"
                                   TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray400}}"/>
                            
                            <!-- Time Info -->
                            <HorizontalStackLayout Grid.Row="2" Grid.ColumnSpan="2" Spacing="16" Margin="0,8,0,0">
                                <Label Text="{Binding ScheduledTime}"
                                       FontSize="12"
                                       TextColor="{StaticResource Primary}"/>
                                <Label Text="{Binding HoursWorkedDisplay}"
                                       FontSize="12"
                                       TextColor="{StaticResource Success}"
                                       IsVisible="{Binding HasHoursWorked}"/>
                            </HorizontalStackLayout>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
            <CollectionView.EmptyView>
                <controls:EmptyStateView 
                    Message="No jobs scheduled for today"
                    Icon="calendar"/>
            </CollectionView.EmptyView>
        </CollectionView>

        <!-- Bottom Action Buttons -->
        <Grid Grid.Row="3" 
              ColumnDefinitions="*,*" 
              ColumnSpacing="12" 
              Margin="16"
              x:Name="ActionButtonsGrid">
            
            <Button Grid.Column="0"
                    x:Name="ClockInButton"
                    Text="CLOCK IN"
                    BackgroundColor="{StaticResource Success}"
                    TextColor="White"
                    FontSize="18"
                    FontAttributes="Bold"
                    CornerRadius="16"
                    HeightRequest="70"
                    Clicked="OnClockInClicked"
                    IsEnabled="False"/>
            
            <Button Grid.Column="1"
                    x:Name="ClockOutButton"
                    Text="CLOCK OUT"
                    BackgroundColor="{StaticResource Danger}"
                    TextColor="White"
                    FontSize="18"
                    FontAttributes="Bold"
                    CornerRadius="16"
                    HeightRequest="70"
                    Clicked="OnClockOutClicked"
                    IsVisible="False"/>
            
            <Button Grid.Column="1"
                    x:Name="BreakButton"
                    Text="BREAK"
                    BackgroundColor="{StaticResource Warning}"
                    TextColor="White"
                    FontSize="18"
                    FontAttributes="Bold"
                    CornerRadius="16"
                    HeightRequest="70"
                    Clicked="OnBreakClicked"
                    IsVisible="False"/>
        </Grid>

    </Grid>

</ContentPage>
