<Window x:Class="OneManVan.Dialogs.AddEditAssetDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Add Asset" Height="700" Width="650"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        ResizeMode="CanResize"
        MinHeight="550" MinWidth="550">

    <Window.Resources>
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryBrush}"/>
            <Setter Property="Margin" Value="0,15,0,10"/>
        </Style>
        
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="{DynamicResource SubtextBrush}"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>
        
        <Style x:Key="FormTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Surface2Brush}"/>
            <Setter Property="CaretBrush" Value="{DynamicResource TextBrush}"/>
            <Setter Property="SelectionBrush" Value="{DynamicResource PrimaryBrush}"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ScrollViewer x:Name="PART_ContentHost" Focusable="false" 
                                          HorizontalScrollBarVisibility="Hidden" 
                                          VerticalScrollBarVisibility="Hidden"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource PrimaryBrush}"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource OverlayBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- ComboBox Toggle Button Template -->
        <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="ToggleButton">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="20"/>
                </Grid.ColumnDefinitions>
                <Border x:Name="Border"
                        Grid.ColumnSpan="2"
                        Background="{DynamicResource SurfaceBrush}"
                        BorderBrush="{DynamicResource Surface2Brush}"
                        BorderThickness="1"
                        CornerRadius="6"/>
                <Path x:Name="Arrow"
                      Grid.Column="1"
                      Fill="{DynamicResource SubtextBrush}"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Data="M 0 0 L 4 4 L 8 0 Z"/>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="Border" Property="BorderBrush" Value="{DynamicResource OverlayBrush}"/>
                </Trigger>
                <Trigger Property="IsChecked" Value="True">
                    <Setter TargetName="Border" Property="BorderBrush" Value="{DynamicResource PrimaryBrush}"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        
        <Style x:Key="FormComboBox" TargetType="ComboBox">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Surface2Brush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton"
                                          Template="{StaticResource ComboBoxToggleButton}"
                                          Focusable="false"
                                          IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                          ClickMode="Press"/>
                            <ContentPresenter x:Name="ContentSite"
                                              IsHitTestVisible="False"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                              Margin="12,8,25,8"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Left">
                                <ContentPresenter.Resources>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                    </Style>
                                </ContentPresenter.Resources>
                            </ContentPresenter>
                            <TextBox x:Name="PART_EditableTextBox"
                                     Style="{x:Null}"
                                     HorizontalAlignment="Left"
                                     VerticalAlignment="Center"
                                     Margin="12,8,25,8"
                                     Focusable="True"
                                     Background="Transparent"
                                     Foreground="{DynamicResource TextBrush}"
                                     CaretBrush="{DynamicResource TextBrush}"
                                     Visibility="Hidden"
                                     IsReadOnly="{TemplateBinding IsReadOnly}"/>
                            <Popup x:Name="Popup"
                                   Placement="Bottom"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   PopupAnimation="Slide">
                                <Grid x:Name="DropDown"
                                      SnapsToDevicePixels="True"
                                      MinWidth="{TemplateBinding ActualWidth}"
                                      MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder"
                                            Background="{DynamicResource SurfaceBrush}"
                                            BorderBrush="{DynamicResource Surface2Brush}"
                                            BorderThickness="1"
                                            CornerRadius="6"
                                            Margin="0,2,0,0">
                                        <ScrollViewer Margin="4" SnapsToDevicePixels="True">
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEditable" Value="True">
                                <Setter Property="IsTabStop" Value="False"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
                        <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                        <Setter Property="Padding" Value="12,8"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ComboBoxItem">
                                    <Border x:Name="Bd" 
                                            Background="{TemplateBinding Background}"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsHighlighted" Value="True">
                                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource Surface2Brush}"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Bd" Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                                            <Setter Property="Foreground" Value="{DynamicResource BackgroundBrush}"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource BackgroundBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="{DynamicResource Surface2Brush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Padding="20,15,20,10">
            <StackPanel>
                <!-- Customer Selection -->
                <TextBlock Text="Customer &amp; Location" Style="{StaticResource SectionHeader}" Margin="0,0,0,10"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Margin="0,0,0,12">
                        <TextBlock Text="Customer *" Style="{StaticResource FieldLabel}"/>
                        <ComboBox x:Name="CustomerCombo" Style="{StaticResource FormComboBox}"
                                  SelectionChanged="CustomerCombo_SelectionChanged"
                                  DisplayMemberPath="Name"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="2" Margin="0,0,0,12">
                        <TextBlock Text="Site" Style="{StaticResource FieldLabel}"/>
                        <ComboBox x:Name="SiteCombo" Style="{StaticResource FormComboBox}"
                                  DisplayMemberPath="FullAddress"/>
                    </StackPanel>
                </Grid>

                <!-- Equipment Identification -->
                <TextBlock Text="Equipment Identification" Style="{StaticResource SectionHeader}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,0,12">
                        <TextBlock Text="Serial Number *" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="SerialTextBox" Style="{StaticResource FormTextBox}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Row="0" Grid.Column="2" Margin="0,0,0,12">
                        <TextBlock Text="Asset Tag" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="AssetTagTextBox" Style="{StaticResource FormTextBox}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,0,12">
                        <TextBlock Text="Brand/Manufacturer" Style="{StaticResource FieldLabel}"/>
                        <ComboBox x:Name="BrandCombo" Style="{StaticResource FormComboBox}" IsEditable="True"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,0,0,12">
                        <TextBlock Text="Model Number" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="ModelTextBox" Style="{StaticResource FormTextBox}"/>
                    </StackPanel>
                </Grid>

                <StackPanel Margin="0,0,0,12">
                    <TextBlock Text="Nickname (e.g., 'Main Floor AC', 'Basement Furnace')" Style="{StaticResource FieldLabel}"/>
                    <TextBox x:Name="NicknameTextBox" Style="{StaticResource FormTextBox}"/>
                </StackPanel>

                <!-- Equipment Type -->
                <TextBlock Text="Equipment Type" Style="{StaticResource SectionHeader}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Margin="0,0,0,12">
                        <TextBlock Text="Equipment Type *" Style="{StaticResource FieldLabel}"/>
                        <ComboBox x:Name="EquipmentTypeCombo" Style="{StaticResource FormComboBox}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="2" Margin="0,0,0,12">
                        <TextBlock Text="Fuel Type" Style="{StaticResource FieldLabel}"/>
                        <ComboBox x:Name="FuelTypeCombo" Style="{StaticResource FormComboBox}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="4" Margin="0,0,0,12">
                        <TextBlock Text="Configuration" Style="{StaticResource FieldLabel}"/>
                        <ComboBox x:Name="UnitConfigCombo" Style="{StaticResource FormComboBox}"/>
                    </StackPanel>
                </Grid>

                <!-- Capacity & Efficiency -->
                <TextBlock Text="Capacity &amp; Efficiency" Style="{StaticResource SectionHeader}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,0,12">
                        <TextBlock Text="BTU Rating" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="BtuTextBox" Style="{StaticResource FormTextBox}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Row="0" Grid.Column="2" Margin="0,0,0,12">
                        <TextBlock Text="Tonnage" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="TonnageTextBox" Style="{StaticResource FormTextBox}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Row="0" Grid.Column="4" Margin="0,0,0,12">
                        <TextBlock Text="SEER Rating" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="SeerTextBox" Style="{StaticResource FormTextBox}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,0,12">
                        <TextBlock Text="AFUE %" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="AfueTextBox" Style="{StaticResource FormTextBox}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,0,0,12">
                        <TextBlock Text="HSPF" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="HspfTextBox" Style="{StaticResource FormTextBox}"/>
                    </StackPanel>
                </Grid>

                <!-- Refrigerant -->
                <TextBlock Text="Refrigerant" Style="{StaticResource SectionHeader}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Margin="0,0,0,12">
                        <TextBlock Text="Refrigerant Type" Style="{StaticResource FieldLabel}"/>
                        <ComboBox x:Name="RefrigerantCombo" Style="{StaticResource FormComboBox}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="2" Margin="0,0,0,12">
                        <TextBlock Text="Charge (oz)" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="RefrigerantChargeTextBox" Style="{StaticResource FormTextBox}"/>
                    </StackPanel>
                </Grid>

                <!-- Installation & Warranty -->
                <TextBlock Text="Installation &amp; Warranty" Style="{StaticResource SectionHeader}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Margin="0,0,0,12">
                        <TextBlock Text="Install Date" Style="{StaticResource FieldLabel}"/>
                        <DatePicker x:Name="InstallDatePicker"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="2" Margin="0,0,0,12">
                        <TextBlock Text="Warranty Start" Style="{StaticResource FieldLabel}"/>
                        <DatePicker x:Name="WarrantyStartPicker"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="4" Margin="0,0,0,12">
                        <TextBlock Text="Warranty Years" Style="{StaticResource FieldLabel}"/>
                        <TextBox x:Name="WarrantyYearsTextBox" Style="{StaticResource FormTextBox}" Text="10"/>
                    </StackPanel>
                </Grid>

                <!-- Filter Info -->
                <TextBlock Text="Filter Information" Style="{StaticResource SectionHeader}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Margin="0,0,0,12">
                        <TextBlock Text="Filter Size" Style="{StaticResource FieldLabel}"/>
                        <ComboBox x:Name="FilterSizeCombo" Style="{StaticResource FormComboBox}" IsEditable="True"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="2" Margin="0,0,0,12">
                        <TextBlock Text="Filter Type" Style="{StaticResource FieldLabel}"/>
                        <ComboBox x:Name="FilterTypeCombo" Style="{StaticResource FormComboBox}"/>
                    </StackPanel>
                </Grid>

                <!-- Notes -->
                <TextBlock Text="Notes" Style="{StaticResource SectionHeader}"/>
                
                <StackPanel Margin="0,0,0,12">
                    <TextBox x:Name="NotesTextBox" Style="{StaticResource FormTextBox}" 
                             TextWrapping="Wrap" AcceptsReturn="True" Height="80"/>
                </StackPanel>

                <!-- Status -->
                <Border Background="{DynamicResource SurfaceBrush}" CornerRadius="6" Padding="15" Margin="0,10,0,0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Status" Style="{StaticResource FieldLabel}"/>
                            <ComboBox x:Name="StatusCombo" Style="{StaticResource FormComboBox}"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" Margin="15,0,0,0">
                            <TextBlock Text="Condition" Style="{StaticResource FieldLabel}"/>
                            <ComboBox x:Name="ConditionCombo" Style="{StaticResource FormComboBox}"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer Buttons -->
        <Border Grid.Row="1" Background="{DynamicResource SurfaceBrush}" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock x:Name="ValidationMessage" Grid.Column="0" 
                           FontSize="12" Foreground="{DynamicResource ErrorBrush}"
                           VerticalAlignment="Center"/>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="Cancel" Click="OnCancelClick"
                            Style="{StaticResource SecondaryButton}" Margin="0,0,10,0"/>
                    <Button x:Name="SaveButton" Content="Save Asset" Click="OnSaveClick"
                            Style="{StaticResource ActionButton}"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
